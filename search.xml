<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Macä¸Šçš„JDKå¤šç‰ˆæœ¬ç®¡ç†]]></title>
    <url>%2F2019%2F09%2Fmanage-multiple-java-versions-on-mac%2F</url>
    <content type="text"><![CDATA[æˆ‘çš„Macä¸Šå·²ç»æœ‰ä¸€ä¸ªJDK8çš„ç‰ˆæœ¬äº†ï¼Œè¿™ä¸JDK13åˆšå‘å¸ƒï¼ˆ2019-09-17ï¼‰ï¼Œæƒ³å¿«é€Ÿçš„å°ä¸€å°é²œï¼Œå°±å¾—å®‰è£…å¤šä¸ªç‰ˆæœ¬çš„JDKäº†ã€‚è¿™ä¸ªå¯¹Nodeã€Rubyã€Pythonçš„ä½¿ç”¨è€…æ¥è¯´ï¼Œå·²ç»ä¸æ˜¯ä¸ªä»€ä¹ˆæ–°é²œè¯é¢˜äº†ï¼Œä½†æ˜¯å¯¹äºŽJavaçš„ä½¿ç”¨è€…æ¥è¯´ï¼Œä¼¼ä¹Žæ²¡æœ‰é‚£ä¹ˆå¤šçš„äººå—åˆ°è¿‡å¤šç‰ˆæœ¬çš„æŠ˜ç£¨ï¼ˆæˆ‘æ˜¯é€šè¿‡GitHubä¸Šnvmã€rbenvã€pyenvã€jenvçš„Staræ•°é‡è‡†æµ‹å‡ºè¿™ä¸ªç»“è®ºçš„ :Pï¼‰ã€‚ nvm rbenv pyenv jenv å®‰è£…JDK 13é€šè¿‡Homebrew å®‰è£…JDK 13ï¼Œå¯ä»¥å…ˆé€šè¿‡brew cask info javaæŸ¥çœ‹ç›®å‰Javaçš„ç‰ˆæœ¬ï¼š 12345678java: 13,33:5b8a42f3905b406298b72d750b6919f6https://openjdk.java.net/Not installedFrom: https://github.com/Homebrew/homebrew-cask/blob/master/Casks/java.rb==&gt; NameOpenJDK Java Development Kit==&gt; Artifactsjdk-13.jdk -&gt; /Library/Java/JavaVirtualMachines/openjdk-13.jdk (Generic Artifact) è¿™é‡Œæ˜¾ç¤ºçš„æ˜¯JDK13ï¼Œæ­£å¥½æ˜¯æˆ‘æƒ³è¦å®‰è£…çš„JDKç‰ˆæœ¬ï¼Œå¦‚æžœä¸æ˜¯ä½ æƒ³è¦çš„ç‰ˆæœ¬å¯ä»¥è‡ªå·±æœç´¢ç›¸åº”çš„ Homebrew Tapã€‚æŽ¥ä¸‹æ¥ç›´æŽ¥å®‰è£…: 123456$ brew cask install java$ java -versionopenjdk version "13" 2019-09-17OpenJDK Runtime Environment (build 13+33)OpenJDK 64-Bit Server VM (build 13+33, mixed mode, sharing) è¿™å°±è¯´æ˜ŽJDK13å·²ç»å®‰è£…å¥½äº†ã€‚ ä½†æ˜¯å¦ä¸€ä¸ªé—®é¢˜æ¥äº†ï¼Œæˆ‘ç”µè„‘ä¸ŠåŽŸæ¥å®‰è£…çš„JDK8åŽ»å“ªå‘¢ï¼Ÿæˆ‘å¦‚ä½•åœ¨ä¸åŒçš„ç‰ˆæœ¬ä¸­éšæ„åˆ‡æ¢å‘¢ï¼Ÿæ¯”å¦‚åƒNodeçš„nvmï¼ŒRubyçš„rvmï¼ŒPythonçš„pyenvç­‰ã€‚ç­”æ¡ˆæ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡jenvæ¥å®žçŽ°ç›¸åŒçš„æ•ˆæžœã€‚ å®‰è£… jEnv å®‰è£… jEnv12$ brew install jenv$ exec $SHELL -l å®‰è£…å®Œæˆä¹‹åŽï¼Œç„¶åŽæ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸã€‚ 1234567$ jenv doctor[OK] No JAVA_HOME set[ERROR] Java binary in path is not in the jenv shims.[ERROR] Please check your path, or try using /path/to/java/home is not a valid path to java installation. PATH : /usr/local/Cellar/jenv/0.5.2/libexec/libexec:/Users/xxx/.cargo/bin:/Users/xxx/.pyenv/shims:/Users/username/.pyenv:/Users/xxx/.nvm/versions/node/v8.11.4/bin:/Users/xxx/bin:/usr/local/bin:/Users/xxx/.cargo/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/go/bin:/Users/xxx/Documents/Projects/golang/bin[ERROR] Jenv is not loaded in your zsh[ERROR] To fix : cat eval "$(jenv init -)" &gt;&gt; /Users/xxx/.zshrc åœ¨è¿™é‡Œå¦‚æžœæŒ‰ç…§æç¤ºæ‰§è¡Œcat eval &quot;$(jenv init -)&quot; &gt;&gt; /Users/xxx/.zshrcï¼šå¯èƒ½ä¼šå¾—åˆ°å¦‚ä¸‹é”™è¯¯ï¼š 12345678910111213141516171819202122cat eval "$(jenv init -)" &gt;&gt; /Users/xxx/.zshrccat: eval: No such file or directorycat: export PATH="/Users/xxx/.jenv/shims:$&#123;PATH&#125;"export JENV_SHELL=zshexport JENV_LOADED=1unset JAVA_HOMEsource '/usr/local/Cellar/jenv/0.5.2/libexec/libexec/../completions/jenv.zsh'jenv rehash 2&gt;/dev/nulljenv() &#123; typeset command command="$1" if [ "$#" -gt 0 ]; then shift fi case "$command" in enable-plugin|rehash|shell|shell-options) eval `jenv "sh-$command" "$@"`;; *) command jenv "$command" "$@";; esac&#125;: No such file or directory ç»è¿‡ä¸€ç•ªæœç´¢ï¼Œå¾—åˆ°å¦‚ä¸‹çš„è§£å†³åŠžæ³•ï¼Œä¸»è¦å°±æ˜¯å°†catæ›¿æ¢ä¸ºechoï¼Œè¿™é‡Œæˆ‘å·²ç»ç»™jEnvæäº†ä¸ªPRï¼Œä»¥æ¶ˆé™¤è¿™ä¸ªå¹²æ‰°ã€‚ Bashç”¨æˆ· 123$ echo 'export PATH="$HOME/.jenv/bin:$PATH"' &gt;&gt; ~/.bash_profile$ echo 'eval "$(jenv init -)"' &gt;&gt; ~/.bash_profile$ exec $SHELL -l Zshç”¨æˆ· 123$ echo 'export PATH="$HOME/.jenv/bin:$PATH"' &gt;&gt; ~/.zshrc$ echo 'eval "$(jenv init -)"' &gt;&gt; ~/.zshrc$ exec $SHELL -l ç„¶åŽå†æ¬¡æ‰§è¡Œjenv doctorï¼Œå¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š 12345[OK] No JAVA_HOME set[ERROR] Java binary in path is not in the jenv shims.[ERROR] Please check your path, or try using /path/to/java/home is not a valid path to java installation. PATH : /usr/local/Cellar/jenv/0.5.2/libexec/libexec:/Users/xxx/.jenv/shims:/Users/xxx/.cargo/bin:/Users/xxx/.pyenv/shims:/Users/username/.pyenv:/Users/xxx/.cargo/bin:/Users/xxx/.pyenv/shims:/Users/username/.pyenv:/Users/xxx/.nvm/versions/node/v8.11.4/bin:/Users/xxx/bin:/usr/local/bin:/Users/xxx/.cargo/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/go/bin:/Users/xxx/Documents/Projects/golang/bin:/Users/xxx/Documents/Projects/golang/bin[OK] Jenv is correctly loaded ä¸ºäº†èƒ½å¤Ÿæ­£ç¡®çš„è®¾ç½®JAVA_HOMEï¼Œæœ€å¥½å¼€å¯exportæ’ä»¶ï¼š 12$ jenv enable-plugin export$ exec $SHELL -l ç®¡ç†ä¸åŒç‰ˆæœ¬çš„JDKæ·»åŠ JDKæ·»åŠ æœ€æ–°å®‰è£…çš„JDKï¼š 1$ jenv add $(/usr/libexec/java_home) å¦‚æžœ/usr/libexec/java_homeæ‰€æŒ‡çš„ä½ç½®ä¸æ˜¯ä½ æƒ³è¦çš„ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨æŒ‡å®šç›®å½•ï¼š 1$ jenv add /Library/Java/JavaVirtualMachines/jdk1.8.0_191.jdk/Contents/Home/ æŸ¥çœ‹JDKç‰ˆæœ¬æ‰§è¡Œjenv versionsï¼š 123456 system* 1.8 (set by JENV_VERSION environment variable) 1.8.0.191 13 openjdk64-13 oracle64-1.8.0.191 é»˜è®¤æƒ…å†µä¸‹ï¼ŒsystemæŒ‡çš„æ˜¯ç³»ç»Ÿä¸­å®‰è£…çš„æœ€æ–°ç‰ˆæœ¬çš„JDKã€‚ åˆ‡æ¢JDKç‰ˆæœ¬ Globalè®¾ç½®å…¨å±€æ¨¡å¼ä¸‹çš„JDKç‰ˆæœ¬ï¼š 123$ jenv global 13$ exec $SHELL -l $ java -version Localåœ¨æŸä¸ªå·¥ä½œç›®å½•ä¸‹è®¾ç½®JDKç‰ˆæœ¬ï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª.java-versionçš„æ–‡ä»¶ï¼š 123$ jenv local 1.8$ exec $SHELL -l $ java -version Shellè®¾ç½®å½“å‰Shell sessionä¸­çš„JDKç‰ˆæœ¬ï¼š 12$ jenv shell 1.8$ java -version å‚è€ƒé“¾æŽ¥ http://www.jenv.be/ https://github.com/jenv/jenv https://emcorrales.com/blog/install-oracle-jdk-macos-homebrew]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>jEnv</tag>
        <tag>Homebrew</tag>
        <tag>JDK</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JVM æ‰§è¡Œ Java ç¨‹åºæ—¶çš„å†…å­˜åŒºåŸŸåˆ’åˆ†]]></title>
    <url>%2F2019%2F09%2Fjava-virtual-machine-runtime-memory-layout%2F</url>
    <content type="text"><![CDATA[åœ¨å­¦ä¹  Java è™šæ‹Ÿæœºï¼ˆåŽé¢ç®€ç§°ï¼šJVMï¼‰ä¸­çš„åžƒåœ¾å›žæ”¶æœºåˆ¶ï¼ˆGCï¼‰ä¹‹å‰ï¼Œå…ˆéœ€è¦äº†è§£ åœ¨ JVM ä¸­çš„ Java ç¨‹åºï¼ˆclass æ–‡ä»¶ï¼‰åŠ è½½åˆ°å†…å­˜ä¹‹åŽåˆ°åº•æ˜¯æ€Žä¹ˆå­˜çš„ã€‚åœ¨é˜…è¯»äº† JVMè§„èŒƒå’Œå‘¨å¿—æ˜Žçš„ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºï¼ˆç¬¬2ç‰ˆï¼‰ã€‹ä¹‹åŽï¼Œæ€»ç»“ä¸€ä¸‹JVMä¸­çš„å†…å­˜åˆ’åˆ†ä»¥åŠå„ä¸ªåŒºåŸŸçš„ä½œç”¨ã€‚ åœ¨JVMè§„èŒƒä¸­å®šä¹‰äº†5ç§è¿è¡Œæ—¶çš„æ•°æ®åŒºåŸŸï¼šç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰ã€Javaè™šæ‹Ÿæœºæ ˆï¼ˆJVM Stacksï¼‰ã€å †ï¼ˆHeapï¼‰ã€æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰ã€è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰ã€æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰ã€‚åœ¨å‘¨å¿—æ˜Žçš„ä¹¦ä¸­è¿˜æåˆ°äº†ç›´æŽ¥å†…å­˜ï¼ˆDirect Memoryï¼‰ï¼Œå®ƒå¹¶ä¸æ˜¯JVMè¿è¡Œæ—¶æ•°æ®åŒºåŸŸçš„ä¸€éƒ¨åˆ†ï¼Œåœ¨JVMçš„è§„èŒƒä¸­ä¹Ÿæ²¡æœ‰ç›¸å…³çš„å®šä¹‰ã€‚ä¸‹é¢åˆ†åˆ«æ¥è¯´æ˜Žå„è‡ªçš„ç”¨é€”ã€‚ ç¨‹åºè®¡æ•°å™¨ç¨‹åºè®¡æ•°å™¨ï¼Œä¹Ÿå«PC Registerã€‚å®ƒçš„ç”¨é€”å¾ˆå•ä¸€ï¼Œä½†æ˜¯å´æ˜¯å¾ˆå¤šåŠŸèƒ½çš„åŸºç¡€ã€‚å¦‚æžœçº¿ç¨‹å½“å‰æ‰§è¡Œçš„æ˜¯Nativeæ–¹æ³•ï¼Œé‚£ä¹ˆå¯„å­˜å™¨é‡Œçš„å€¼å°±æ˜¯Undefinedï¼›å¦‚æžœçº¿ç¨‹å½“å‰æ‰§è¡Œçš„æ˜¯éžNativeæ–¹æ³•ï¼Œé‚£ä¹ˆå¯„å­˜å™¨é‡Œçš„å€¼å°±æ˜¯å½“å‰æ‰§è¡Œçš„JVMå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ã€‚åƒæˆ‘ä»¬å¸¸ç”¨çš„åˆ†æ”¯ã€å¾ªçŽ¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹æ¢å¤ç­‰éƒ½ä¾èµ–äºŽå®ƒã€‚ ç”±äºŽJVMæ”¯æŒå¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œï¼Œæ‰€ä»¥æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨ï¼Œå„ä¸ªçº¿ç¨‹äº’ä¸å½±å“ï¼Œè¿™ç±»å†…å­˜åŒºåŸŸä¹Ÿç§°ä¹‹ä¸ºçº¿ç¨‹ç§æœ‰çš„ã€‚ Javaè™šæ‹Ÿæœºæ ˆè™šæ‹Ÿæœºæ ˆä¹Ÿæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œéšç€ä¸€ä¸ªçº¿ç¨‹çš„åˆ›å»ºè€Œåˆ›å»ºï¼Œä¸»è¦ç”¨æ¥å­˜å‚¨æ ˆå¸§ï¼ˆStack Frameï¼‰ã€‚ä»€ä¹ˆæ˜¯æ ˆå¸§å‘¢ï¼Ÿåœ¨Javaä¸­ï¼Œæ¯ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œæ—¶å°±ä¼šå…ˆåˆ›å»ºä¸€ä¸ªæ ˆå¸§å¹¶æ”¾å…¥è™šæ‹Ÿæœºæ ˆä¸­ï¼Œåœ¨æ–¹æ³•æ‰§è¡Œå®Œæ¯•æ—¶å†ä»Žè™šæ‹Ÿæœºæ ˆä¸­ç§»é™¤è¯¥æ ˆå¸§ã€‚å®ƒä¸»è¦ç”¨æ¥å­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æŽ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚æˆ‘ä»¬å¸¸è¯´çš„å †ï¼ˆHeapï¼‰å’Œæ ˆï¼ˆStackï¼‰ä¸­çš„æ ˆï¼ŒæŒ‡çš„å°±æ˜¯è™šæ‹Ÿæœºæ ˆã€‚ åœ¨JVMè§„èŒƒä¸­å¹¶æ²¡æœ‰å¯¹è™šæ‹Ÿæœºæ ˆç©ºé—´çš„å¤§å°åšé™åˆ¶ï¼Œå¯ä»¥è®¾ç½®ä¸ºå›ºå®šå¤§å°çš„ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸ºå¯æ‰©å±•çš„ã€‚ä½†æ˜¯åœ¨è§„èŒƒä¸­å®šä¹‰äº†ä¸¤ç§å¼‚å¸¸æƒ…å†µï¼š å¦‚æžœè®¡ç®—æ—¶è¯·æ±‚çš„æ ˆç©ºé—´å¤§äºŽè™šæ‹Ÿæœºæ ˆçš„æœ€å¤§å€¼ï¼Œåˆ™ä¼šæŠ›å‡ºStackOverflowErrorå¼‚å¸¸ï¼› å¦‚æžœè™šæ‹Ÿæœºæ ˆè®¾ç½®ä¸ºå¯æ‰©å±•çš„å¹¶ä¸”æ— æ³•å†èŽ·å–æ›´å¤šå†…å­˜æ—¶ï¼Œåˆ™ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ å †ç›¸æ¯”è€Œè¨€ï¼Œå †åœ¨JVMç®¡ç†çš„å†…å­˜åŒºåŸŸä¸­å±žäºŽæœ€å¤§çš„ä¸€å—ï¼Œéšç€è™šæ‹Ÿæœºçš„å¯åŠ¨è€Œåˆ›å»ºï¼Œç”¨æ¥å­˜å‚¨æ‰€æœ‰çš„classå®žä¾‹å’Œæ•°ç»„ï¼Œæ‰€æœ‰çº¿ç¨‹å…±äº«è¿™ä¸€åŒºåŸŸï¼Œè¯¥åŒºåŸŸä¹Ÿæ˜¯åžƒåœ¾å›žæ”¶çš„ä¸»è¦åŒºåŸŸã€‚è™½ç„¶JVMè§„èŒƒä¸­è¯´æ‰€æœ‰çš„å¯¹è±¡å®žä¾‹éƒ½åœ¨è¯¥åŒºåŸŸåˆ†é…ç©ºé—´ï¼Œä½†æ˜¯éšç€JITæŠ€æœ¯çš„é€æ­¥å‘å±•ï¼Œè¿™ä¸€è¯´æ³•ä¹Ÿä¸ä¸¥è°¨äº†ã€‚ å †ç©ºé—´çš„å¤§å°ä¹Ÿå¯ä»¥è®¾ç½®ä¸ºå›ºå®šå¤§å°ï¼Œæˆ–è€…å¯æ‰©å±•çš„ã€‚ä½†ä¸ç®¡æ˜¯ä½•ç§æ–¹å¼ï¼Œè§„èŒƒä¸­è¿˜æ˜¯å®šä¹‰äº†ä¸€ç§å¼‚å¸¸åœºæ™¯ï¼š å¦‚æžœè®¡ç®—éœ€è¦æ›´å¤šçš„å †ç©ºé—´è€Œæ— æ³•æ»¡è¶³æ—¶ï¼Œåˆ™ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ æ–¹æ³•åŒºæ–¹æ³•åŒºå’Œå †ä¸€æ ·ï¼Œä¹Ÿæ˜¯éšç€è™šæ‹Ÿæœºå¯åŠ¨è€Œåˆ›å»ºï¼Œæ‰€æœ‰çº¿ç¨‹å…±äº«ï¼Œä¸»è¦ç”¨æ¥å­˜å‚¨è¢«JVMåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ç­‰ä¿¡æ¯ã€‚ JVMè§„èŒƒä¸­å¹¶æœªä¸¥æ ¼è¦æ±‚è¦å¯¹è¯¥åŒºåŸŸè¿›è¡Œåžƒåœ¾å›žæ”¶ï¼Œä½†æ˜¯HotSpotè™šæ‹Ÿæœºåœ¨åžƒåœ¾å›žæ”¶çš„æ—¶å€™è¿˜æ˜¯ä¼šè€ƒè™‘è¯¥åŒºåŸŸï¼Œåœ¨åˆ†ä»£åžƒåœ¾å›žæ”¶ä¸­æ‰€è¯´çš„â€œæ°¸ä¹…ä»£â€æŒ‡çš„å°±æ˜¯æ–¹æ³•åŒºã€‚æ–¹æ³•åŒºçš„å¤§å°ä¹Ÿå¯ä»¥è®¾ç½®ä¸ºå›ºå®šå¤§å°ï¼Œæˆ–è€…å¯æ‰©å±•çš„ã€‚ä½†ä¸ç®¡æ˜¯ä½•ç§æ–¹å¼ï¼Œè§„èŒƒä¸­è¿˜æ˜¯å®šä¹‰äº†ä¸€ç§å¼‚å¸¸åœºæ™¯ï¼š å¦‚æžœè®¡ç®—éœ€è¦æ›´å¤šçš„æ–¹æ³•åŒºç©ºé—´è€Œæ— æ³•æ»¡è¶³æ—¶ï¼Œåˆ™ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ è¿è¡Œæ—¶å¸¸é‡æ± è¿è¡Œæ—¶å¸¸é‡æ± æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºŽå­˜å‚¨ç¼–è¯‘æœŸç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ã€‚åœ¨Javaä¸­å¹¶ä¸è¦æ±‚å¸¸é‡ä¸€å®šåªæœ‰ç¼–è¯‘æœŸæ‰èƒ½äº§ç”Ÿï¼Œè¿è¡ŒæœŸé—´ä¹Ÿå¯èƒ½å°†æ–°çš„å¸¸é‡æ”¾å…¥æ± ä¸­ï¼Œä¾‹å¦‚Stringç±»çš„intern()æ–¹æ³•ã€‚ æ¯ä¸ªè¿è¡Œæ—¶å¸¸é‡æ± éƒ½æ˜¯éšç€ä¸€ä¸ªç±»æˆ–è€…æŽ¥å£çš„åˆ›å»ºè€Œåˆ›å»ºçš„ã€‚åœ¨è§„èŒƒä¸­å®šä¹‰äº†ä¸€ç§å¼‚å¸¸åœºæ™¯ï¼š åœ¨åˆ›å»ºä¸€ä¸ªç±»æˆ–è€…æŽ¥å£æ—¶ï¼Œå¦‚æžœè¿è¡Œæ—¶çš„å¸¸é‡æ± æ— æ³•åˆ†é…åˆ°è¶³å¤Ÿçš„ç©ºé—´æ—¶ï¼Œåˆ™ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ æœ¬åœ°æ–¹æ³•æ ˆæœ¬åœ°æ–¹æ³•æ ˆå’Œè™šæ‹Ÿæœºæ ˆç±»ä¼¼ï¼Œä¹Ÿæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œéšç€ä¸€ä¸ªçº¿ç¨‹çš„åˆ›å»ºè€Œåˆ›å»ºï¼Œåªä¸è¿‡è™šæ‹Ÿæœºæ ˆæ˜¯ç”¨æ¥æœåŠ¡Javaæ–¹æ³•è°ƒç”¨ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆæ˜¯ç”¨æ¥æœåŠ¡æœ¬åœ°æ–¹æ³•è°ƒç”¨çš„ã€‚ åœ¨JVMè§„èŒƒä¸­å¹¶æ²¡æœ‰å¯¹æœ¬åœ°æ–¹æ³•æ ˆç©ºé—´çš„å¤§å°åšé™åˆ¶ï¼Œå¯ä»¥è®¾ç½®ä¸ºå›ºå®šå¤§å°çš„ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸ºå¯æ‰©å±•çš„ã€‚åœ¨è§„èŒƒä¸­ä¹Ÿå®šä¹‰äº†ä¸¤ç§å¼‚å¸¸æƒ…å†µï¼š å¦‚æžœè®¡ç®—æ—¶è¯·æ±‚çš„æ ˆç©ºé—´å¤§äºŽæœ¬åœ°æ–¹æ³•æ ˆçš„æœ€å¤§å€¼ï¼Œåˆ™ä¼šæŠ›å‡ºStackOverflowErrorå¼‚å¸¸ï¼› å¦‚æžœæœ¬åœ°æ–¹æ³•æ ˆè®¾ç½®ä¸ºå¯æ‰©å±•çš„å¹¶ä¸”æ— æ³•å†èŽ·å–æ›´å¤šå†…å­˜æ—¶ï¼Œåˆ™ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ ç›´æŽ¥å†…å­˜*ç›´æŽ¥å†…å­˜ä¸å—è™šæ‹Ÿæœºå‚æ•°çš„æŽ§åˆ¶ï¼Œåœ¨NIOä¸­æœ‰ä¸€ç§åŸºäºŽé€šé“ï¼ˆChannelï¼‰ä¸Žç¼“å†²åŒºï¼ˆBuffer)çš„I/Oæ–¹å¼ï¼Œå®ƒå¯ä»¥é€šè¿‡Nativeæ–¹æ³•åœ¨å †å¤–åˆ†é…å†…å­˜ï¼Œç„¶åŽé€šè¿‡DirectByteBufferå¯¹è±¡æ¥å¼•ç”¨è¿™å—å†…å­˜ã€‚å› ä¸ºé¿å…äº†åœ¨Javaå †å’ŒNativeå †ä¹‹é—´æ¥å›žå¤åˆ¶æ•°æ®ï¼Œä»Žè€Œåœ¨æŸäº›åœºæ™¯ä¸­èƒ½å¤Ÿå¾—åˆ°æ€§èƒ½çš„æå‡ã€‚ä¸€æ—¦ä½¿ç”¨çš„ç›´æŽ¥å†…å­˜è¶…è¿‡äº†ç‰©ç†å†…å­˜çš„æ€»å’Œï¼Œåˆ™ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ å‚è€ƒé“¾æŽ¥ https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-2.html#jvms-2.5 https://book.douban.com/subject/24722612/]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>JVM</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åœ¨MySQLä¸­ä½¿ç”¨LAST_INSERT_IDèŽ·å–å”¯ä¸€è‡ªå¢žåºåˆ—]]></title>
    <url>%2F2019%2F07%2Fimplement-sequence-with-mysql-last-insert-id%2F</url>
    <content type="text"><![CDATA[ä¸€èˆ¬å¦‚æžœé‡åˆ°ç”Ÿæˆå…¨å±€å”¯ä¸€çš„è‡ªå¢žIDçš„éœ€æ±‚æ—¶ï¼Œå¾€å¾€ç¬¬ä¸€ååº”éƒ½æ˜¯ç›´æŽ¥åˆ©ç”¨æ•°æ®çš„Sequenceå¯¹è±¡ï¼Œç®€å•ï¼Œç›´æŽ¥äº†å½“ã€‚ä½†æ˜¯MySQLååä¸æ”¯æŒSequenceå¯¹è±¡ï¼Œé‚£æˆ‘ä»¬è¯¥å¦‚ä½•æ˜¯å¥½å‘¢ï¼Ÿ ä»€ä¹ˆæ˜¯SequenceSequenceä¹Ÿå«åšåºåˆ—ï¼Œä¸€èˆ¬ç”¨åšè¡¨çš„ä¸»é”®ï¼Œæˆ–è€…ä¸€äº›é¡¹ç›®çš„ç¼–å·ç­‰ã€‚ä¸€èˆ¬å…·æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š å…¨è¡¨å”¯ä¸€ è‡ªå¢ž ä¸ä¸€å®šä¸¥æ ¼è¿žç»­ï¼ˆä¸­é—´ç”±äºŽäº‹åŠ¡çš„å›žæ»šå¯èƒ½ä¼šå‡ºçŽ°æ´žï¼Œæ¯”å¦‚1ï¼Œ2ï¼Œ3ï¼Œ5ï¼Œ6ï¼‰ åœ¨å¸¸è§çš„å‡ ç§æ•°æ®åº“ä¸­ï¼ŒOracleã€SQL Serveréƒ½å†…ç½®æœ‰Sequenceå¯¹è±¡ï¼Œå…·ä½“ç”¨æ³•å°±ä¸åœ¨æ­¤èµ˜è¿°äº†ã€‚åœ¨æœ¬æ–‡ä¸­æˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸‹å¦‚ä½•åœ¨åŽŸç”Ÿä¸æ”¯æŒSequenceçš„MySQLï¼ˆç›®å‰æœ€æ–°çš„å¤§ç‰ˆæœ¬ä¸º8.0ï¼‰ä¸­æ¨¡æ‹Ÿå‡ºSequenceçš„æ•ˆæžœã€‚ å¦‚ä½•åœ¨MySQLä¸­æ¨¡æ‹ŸSequenceMySQLä¸­çš„auto_incrementä¸€èˆ¬æ˜¯ç”¨æ¥ç”Ÿæˆè¡¨çš„ä¸»é”®ï¼Œæœ¬èº«èƒ½å¤Ÿç”Ÿæˆè‡ªå¢žçš„å”¯ä¸€IDï¼Œä½†æ˜¯ä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ªåˆ—å¸¦æœ‰auto_incrementå±žæ€§ã€‚åœ¨å®žé™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ä¸æ­¢ä¸€ç§åºåˆ—å·ï¼Œæ¯”å¦‚é¡¹ç›®ç¼–å·ï¼ˆPROJ-001ï¼ŒPROJ-002â€¦ï¼‰ã€å‘ç¥¨ç¼–å·ï¼ˆINV-0001ï¼ŒINV-0002â€¦ï¼‰ï¼Œè®¢å•ç¼–å·ï¼ˆORD-0001ï¼ŒORD-0002â€¦ï¼‰ç­‰ç­‰ï¼Œä¸‹é¢å°†é€šè¿‡auto_incrementå’ŒLAST_INSERT_IDç›¸ç»“åˆå®žçŽ°è¯¥åŠŸèƒ½ã€‚ LAST_INSERT_IDå‡½æ•°è¯¥å‡½æ•°æœ‰ä¸¤ç§å½¢å¼ï¼šLAST_INSERT_ID(), LAST_INSERT_ID(expr)ã€‚æ— å‚çš„å½¢å¼ä¼šè¿”å›žæœ€è¿‘ä¸€æ¬¡æ‰§è¡ŒINSERTè¯­å¥æ—¶auto_incrementçš„å€¼ï¼›å¸¦exprçš„å½¢å¼ä¼šè¿”å›žè¡¨è¾¾å¼çš„å€¼ï¼Œå¹¶ä¸”è¯¥å€¼ä¼šè¢«è®°ä½ï¼Œåœ¨ä¸‹ä¸€æ¬¡è°ƒç”¨LAST_INSERT_ID()æ—¶ä¹Ÿè¿”å›žè¯¥å€¼ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ã€‚ é¦–å…ˆåˆ›å»ºä¸€å¼ è¡¨ï¼š 1234CREATE TABLE user ( id INT AUTO_INCREMENT PRIMARY KEY, name VARCHAR(50) NOT NULL); ç„¶åŽæ’å…¥ä¸¤æ¡æ•°æ®ï¼š 1234INSERT INTO user(name) VALUES(&apos;å¼ ä¸‰&apos;);INSERT INTO user(name) VALUES(&apos;æŽå››&apos;);SELECT LAST_INSERT_ID(); æ­¤æ—¶å¾—åˆ°çš„ç»“æžœæ˜¯2ã€‚ æ³¨æ„ï¼šå¦‚æžœæ˜¯ä¸€æ¡è¯­å¥æ’å…¥å¤šæ¡å€¼ï¼Œåˆ™è¿”å›žçš„æ˜¯æ’å…¥ç¬¬ä¸€æ¡æ—¶è‡ªåŠ¨ç”Ÿæˆçš„IDï¼Œè€Œä¸æ˜¯æœ€åŽä¸€æ¡çš„ã€‚ æ¯”å¦‚æˆ‘ä»¬å†æ’å…¥ä¸‰æ¡æ•°æ®ï¼Œä¸è¿‡æ¢ä¸ªå†™æ³•ï¼š 123456INSERT INTO user(name) VALUES(&apos;çŽ‹äº”&apos;), (&apos;èµµå…­&apos;), (&apos;éƒ‘ä¸ƒ&apos;);SELECT LAST_INSERT_ID(); æ­¤æ—¶å¾—åˆ°çš„ç»“æžœæ˜¯3ï¼Œè€Œä¸æ˜¯5ã€‚ èŽ·å–è‡ªå¢žåºåˆ—åœ¨å®žé™…çš„é¡¹ç›®ä¸­æˆ‘ä»¬å®Œå…¨å¯ä»¥æ¢ä¸ªæ–¹å¼ï¼Œé¿å…ä¸Šé¢ðŸ‘†çš„æƒ…å†µï¼Œä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œä½•å¿…æ²¡æœ‰å›°éš¾ï¼Œåˆ¶é€ å›°éš¾ä¸ºéš¾è‡ªå·±å‘¢ï¼ŸæŽ¥ç€çœ‹ä¸‹ä¸€ä¸ªæ›´åŠ é€šç”¨çš„ä¾‹å­ã€‚ åˆ›å»ºå¦ä¸€å¼ è¡¨å¹¶åˆå§‹åŒ–æ•°æ®ï¼š 12345678CREATE TABLE sequence ( id INT AUTO_INCREMENT PRIMARY KEY, seq_type VARCHAR(50) NOT NULL, year INT NOT NULL, current_val BIGINT NOT NULL);INSERT INTO sequence(seq_type, year, current_val) VALUES(&apos;INVOICE&apos;, 2019, 0); æ¯æ¬¡åœ¨èŽ·å–current_valä¹‹å‰ï¼Œå…ˆé€šè¿‡LAST_INSERT_ID(current_val + 1)æ›´æ–°ï¼š 12345UPDATE sequence SET current_val = LAST_INSERT_ID(current_val + 1)WHERE seq_type = &apos;INVOICE&apos; AND year = 2019;SELECT LAST_INSERT_ID(); è¿™æ ·æ¯æ¬¡éƒ½èƒ½èŽ·å–è‡ªå¢žä¹‹åŽçš„å€¼äº†ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¾‹å¤–çš„æƒ…å†µã€‚æ¯”å¦‚ä¸¤ä¸ªäººåŒæ—¶åœ¨èŽ·å–æ–°çš„å€¼ï¼ŒAå…ˆåšäº†updateæ“ä½œï¼Œç„¶åŽBä¹Ÿåšäº†updateæ“ä½œï¼Œç„¶åŽAçš„æ“ä½œç”±äºŽæŸç§åŽŸå› å›žæ»šäº†ï¼ŒBçš„æ“ä½œæˆåŠŸäº†ï¼Œæ­¤æ—¶åºåˆ—ä¸­é—´å°±ä¼šå‡ºçŽ°ä¸€ä¸ªæ´žã€‚è™½ç„¶ä¸æ˜¯ä¸¥æ ¼è¿žç»­çš„ï¼Œä½†æ˜¯åœ¨å¤§å¤šæ•°ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œå·²ç»æ»¡è¶³è¦æ±‚äº†ã€‚ è¿˜éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æžœseq_typeæˆ–è€…yearæ¡ä»¶ä¸æ»¡è¶³ï¼Œé‚£ä¹ˆè¿™é‡Œçš„SELECT LAST_INSERT_ID();å°±ä¼šå§‹ç»ˆè¿”å›žä¸Šä¸€æ¬¡çš„å€¼ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ„æƒ³ä¸åˆ°çš„çš„é”™è¯¯ã€‚ LAST_INSERT_ID() vs. MAX()LAST_INSERT_ID()æ˜¯ä»¥æ•°æ®åº“è¿žæŽ¥ä¸ºåŸºç¡€çš„ï¼Œå³ä½¿æœ‰å¤šä¸ªäººåŒæ—¶é€šè¿‡å¤šä¸ªè¿žæŽ¥èŽ·å–Sequenceä¹Ÿä¸ä¼šæœ‰é—®é¢˜ï¼Œæ¯ä¸ªå®¢æˆ·ç«¯ä¼šèŽ·å–åˆ°å±žäºŽä»–è‡ªå·±çš„åºåˆ—å·ï¼Œä¸ç”¨æ‹…å¿ƒä¼šå—åˆ°å…¶ä»–å®¢æˆ·ç«¯çš„å½±å“ï¼Œæˆ–è€…å½±å“å…¶ä»–å®¢æˆ·ç«¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒMAX()ææ€•å°±ä¸èƒ½æ­£å¸¸å·¥ä½œäº†ã€‚ å‚è€ƒé“¾æŽ¥ https://www.percona.com/community-blog/2018/10/12/generating-identifiers-auto_increment-sequence/ https://dev.mysql.com/doc/refman/8.0/en/information-functions.html#function_last-insert-id http://www.mysqltutorial.org/mysql-last_insert_id.aspx]]></content>
      <categories>
        <category>database</category>
      </categories>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2019%2F07%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
  </entry>
  <entry>
    <title></title>
    <url>%2F404%2F404.html</url>
    <content type="text"><![CDATA[]]></content>
  </entry>
  <entry>
    <title><![CDATA[å…³äºŽæˆ‘]]></title>
    <url>%2Fabout%2Findex.html</url>
    <content type="text"><![CDATA[ç®€åŽ†æ›´æ–°ä¸­â€¦]]></content>
  </entry>
  <entry>
    <title><![CDATA[categories]]></title>
    <url>%2Fcategories%2Findex.html</url>
    <content type="text"></content>
  </entry>
  <entry>
    <title><![CDATA[tags]]></title>
    <url>%2Ftags%2Findex.html</url>
    <content type="text"></content>
  </entry>
</search>
